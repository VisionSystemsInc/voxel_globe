#!/usr/bin/env bash

source $(dirname ${BASH_SOURCE[0]})/common_setup.env

${MKDIR} ${VIP_PID_DIR}

${MKDIR} ${VIP_PID_DIR}
${MKDIR} ${VIP_LOCK_DIR}
${MKDIR} ${VIP_DAEMON_HOME_DIR}
${MKDIR} ${VIP_LOG_DIR}

${MKDIR} ${VIP_IMAGE_SERVER_ROOT}
${MKDIR} ${VIP_DJANGO_STATIC_ROOT}
${MKDIR} ${VIP_TEMP_DIR}
${MKDIR} ${VIP_STORAGE_DIR}

${CHMOD} 777 ${VIP_LOG_DIR} ${VIP_LOG_DIR}/*.log
echo "Totally owning ${VIP_CONF_DIR} and ${VIP_INIT_DIR}"
${CHOWN} -R root:root ${VIP_CONF_DIR}
${CHOWN} -R root:root ${VIP_INIT_DIR}

#Fix for the celeryd file.
${CHMOD} -R ga-w ${VIP_CONF_DIR}

#RabbitMQ
${MKDIR} ${VIP_RABBITMQ_PID_DIR}
${MKDIR} ${VIP_RABBITMQ_LOCK_DIR}
${MKDIR} ${VIP_RABBITMQ_LOG_DIR}

#Celery
${MKDIR} ${VIP_CELERY_PID_DIR}
${MKDIR} ${VIP_CELERY_LOCK_DIR}
${MKDIR} ${VIP_CELERY_LOG_DIR}

#Jupyter
${MKDIR} ${VIP_NOTEBOOK_PID_DIR}
${MKDIR} ${VIP_NOTEBOOK_LOCK_DIR}
${MKDIR} ${VIP_NOTEBOOK_LOG_DIR}

#httpd
${MKDIR} ${VIP_HTTPD_PID_DIR}
${MKDIR} ${VIP_HTTPD_LOCK_DIR}
${MKDIR} ${VIP_HTTPD_LOG_DIR}

#Postgresql
${MKDIR} ${VIP_POSTGRESQL_PID_DIR}
${MKDIR} ${VIP_POSTGRESQL_LOCK_DIR}
${MKDIR} ${VIP_POSTGRESQL_LOG_DIR}
${MKDIR} ${VIP_POSTGRESQL_DATABASE}
${CHMOD} 700 ${VIP_POSTGRESQL_DATABASE}


#I don't think this is needed anymore....
#${CHMOD} 775 ${VIP_DATABASE_DIR}
